<h1>こんな時どうする？の編集</h1>

<p>ケースを追加する場合は「追加」ボタンを押下してください。</p>
<form action="add" method="post">
  <input name="addButton" type="submit" value="ケース追加" onClick= "AddTableRows();"/>
</form>

<p>編集を保存する場合は「保存」ボタンを押下してください。</p>
<form action="save" method="post">
  <input name="saveButton" type="submit" value="保存">
</table>

<p></p>

<table border="1" id="table1">
  <tr>
    <th>ID</th>
    <th>項目</th>
    <th>登録者</th>
    <th>ケース</th>
    <th>変更</th>
    <th>手順</th>
    <th>参照情報</th>
  </tr>
  <% count = @item.cases.length %>
  <tr>
  <td rowspan=<%= count %> valign="top"><%= @item.id %><input type="hidden" name="itemid" value="<%= @item.id %>"></td>
  <td rowspan=<%= count %> valign="top"><textarea name="item" rows="20" cols="20"><%= @item.name %></textarea></td>
  <td rowspan=<%= count %> valign="top"><textarea name="update_user" rows="20" cols="5"><%= @item.update_user %></textarea></td>
  <% @item.cases.each do |a_case| %>
    <input type="hidden" name="caseid[]" value="<%= a_case.id %>">
    <td valign="top"><textarea name="casename[]" rows="20" cols="20"><%= a_case.name %></textarea></td>
    <td valign="top"><%= link_to "削除", {:action => 'delete', :id => a_case.id} %></td>
    <% a_case.procedures.each do |procedure| %>
      <td><textarea name="procedurename[]" rows="20" cols="60"><%= procedure.name %></textarea></td>
      <td><textarea name="reference[]" rows="20" cols="60"><%= procedure.reference %></textarea></td>
  <% end %>
  </tr>
<% end %>
</tr>
</table>

<script type="text/javascript">
function AddTableRows(){
	// ★作成中（この状態では正しく行追加されません）★
	var table1 = document.getElementById("table1");
	var row1 = table1.insertRow(-1);
	var cell1 = row1.insertCell(-1);
	var cell2 = row1.insertCell(-1);
	var cell3 = row1.insertCell(-1);
	var cell4 = row1.insertCell(-1);
	var cell5 = row1.insertCell(-1);
	var cell6 = row1.insertCell(-1);
}
</script>
